# 法术附魔词条效果描述

本文档详细描述所有法术附魔词条的效果机制、触发时机、视觉效果和数值范围。

## 实现注意点：
- 词条组件中加入相关参数（如强度、范围、持续时间等），并在`OnAddOrUpgrade`中添加对应的随机强化
- 如果有减速之类的状态效果，需要在`Source/Content/StatusEffects.cs`里实现一个对应的基线状态

## 普通词条（Common）

### 减速（Slow） √

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，对目标施加减速状态效果
- 降低目标的移动速度，持续一定时间
- 减速效果可与其他状态效果叠加

**视觉效果**：
- 目标身上出现蓝色减速粒子特效，持续显示直到状态结束
- 可通过 `AttachAnimRequest` 在目标身上附加减速光环特效

**数值范围**：
- 移动速度降低：30% - 50%
- 持续时间：3 - 5 秒
- 状态优先级：中等

---

### 爆炸（Explosion）

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，在命中位置生成范围爆炸伤害
- 对爆炸范围内的所有单位造成伤害（包括友方，除非特殊判定）
- 爆炸伤害基于技能基础伤害的一定比例

**视觉效果**：
- 通过 `SpawnAnimRequest` 在命中位置生成爆炸特效
- 爆炸特效包含火焰、烟雾和冲击波动画
- 特效生命周期：0.5 - 1.0 秒

**数值范围**：
- 爆炸范围：1.5 - 3.0 单位半径
- 爆炸伤害系数：80% - 120% 基础伤害
- 可穿透部分障碍物

---

### 急速（Haste）

**触发时机**：OnSetup

**效果机制**：
- 技能创建时调整弹道速度
- 提升技能弹道的飞行速度，使目标更难躲避
- 不影响技能的伤害和范围

**视觉效果**：
- 弹道外观可能略微拉长或带有速度拖尾效果
- 可通过 `AttachAnimRequest` 在弹道上附加速度粒子特效

**数值范围**：
- 弹速提升：50% - 100%
- 仅影响弹道速度，不影响施法速度

---

### 熟练（Proficiency）

**触发时机**：OnSetup

**效果机制**：
- 技能创建时减少施法前摇时间
- 缩短技能从开始施放到实际发射的延迟
- 提高技能的响应速度和连击流畅度

**视觉效果**：
- 施法者身上可能出现短暂的熟练度光环
- 施法动作可能略微加速

**数值范围**：
- 施法前摇减少：30% - 50%
- 不影响技能冷却时间

---

### 强化（Empower）√

**触发时机**：OnSetup / OnEffectObj

**效果机制**：
- OnSetup 阶段：提升技能的基础伤害系数

**视觉效果**：
- 技能弹道可能带有强化光效（如金色或紫色光芒）
- OnEffectObj命中时可能出现额外的伤害数字特效

**数值范围**：
- 伤害提升：20% - 40%
- 可与其他伤害加成叠加

---

### 击飞（Knockback）

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，对目标施加击退或击飞力
- 根据命中角度和位置计算击飞方向
- 击飞距离和高度取决于目标重量和技能强度

**视觉效果**：
- 命中时出现冲击波特效
- 目标被击飞时带有抛物线轨迹
- 通过 `SpawnAnimRequest` 生成击飞冲击特效

**数值范围**：
- 击飞距离：2 - 5 单位
- 击飞高度：1 - 3 单位
- 击飞力受目标重量影响，重型单位击飞距离较短

---

### 剧毒（Poison）√

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，对目标施加中毒状态
- 中毒状态持续造成伤害（DoT - Damage over Time）
- 中毒效果可叠加层数，每层独立计算伤害

**视觉效果**：
- 目标身上出现绿色毒雾粒子特效
- 中毒期间持续显示毒液滴落动画
- 可通过 `AttachAnimRequest` 附加毒液光环

**数值范围**：
- 每层中毒伤害：技能基础伤害的 10% - 20%
- 中毒持续时间：5 - 10 秒
- 最大叠加层数：3 - 5 层
- 每层独立计时

---

### 灼烧（Burn）√

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，对目标施加灼烧状态
- 灼烧状态持续造成火焰伤害（火 DoT）
- 灼烧效果可能引燃周围的可燃物

**视觉效果**：
- 目标身上出现火焰粒子特效和烟雾
- 持续显示燃烧动画
- 通过 `AttachAnimRequest` 附加火焰光环特效

**数值范围**：
- 灼烧伤害：技能基础伤害的 15% - 25%
- 灼烧持续时间：4 - 8 秒
- 可与其他火焰效果叠加

---

### 冰冻（Freeze）

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，对目标施加冰冻状态
- 冰冻状态下目标无法移动和攻击
- 冰冻期间目标受到伤害可能增加（易碎效果）

**视觉效果**：
- 目标被冰晶覆盖，出现蓝色冰霜特效
- 冰冻期间持续显示冰晶闪烁动画
- 通过 `AttachAnimRequest` 附加冰霜光环

**数值范围**：
- 冰冻持续时间：2 - 4 秒
- 冰冻期间易伤：+20% - +40% 受到的伤害
- 冰冻状态可被高温效果解除

## 稀有词条（Rare）

### 锁定（LockOn）

**触发时机**：OnSetup

**效果机制**：
- 技能创建时锁定单一目标
- 弹道自动追踪锁定目标，无视目标移动
- 锁定目标后弹道会调整方向确保命中

**视觉效果**：
- 目标身上出现锁定标记（如红色准星）
- 弹道带有追踪轨迹特效

**数值范围**：
- 锁定范围：10 - 20 单位
- 锁定优先级：最近敌人 > 血量最低 > 随机
- 锁定后弹道转向速度：中等

---

### 巨大（Huge）√

**触发时机**：OnSetup

**效果机制**：
- 技能创建时放大弹道的贴图尺寸和碰撞半径
- 增大弹道的视觉体积和实际碰撞范围
- 提高命中率，但可能影响穿透判定

**视觉效果**：
- 弹道贴图放大 1.5 - 2.0 倍
- 碰撞半径相应增大

**数值范围**：
- 贴图缩放：150% - 200%
- 碰撞半径缩放：150% - 200%
- 伤害和速度不受影响

---

### 衰弱（Weaken）

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，对目标施加衰弱 debuff
- 降低目标的攻击力和防御力
- 衰弱效果持续一定时间

**视觉效果**：
- 目标身上出现灰色衰弱粒子特效
- 通过 `AttachAnimRequest` 附加衰弱光环

**数值范围**：
- 攻击力降低：20% - 40%
- 防御力降低：20% - 40%
- 持续时间：5 - 10 秒

---

### 破甲（ArmorBreak）

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，对目标施加破甲 debuff
- 大幅降低目标的护甲值
- 使后续攻击更容易造成伤害

**视觉效果**：
- 目标身上出现护甲破碎特效
- 通过 `AttachAnimRequest` 附加破甲标记

**数值范围**：
- 护甲降低：50% - 80%
- 持续时间：3 - 6 秒
- 可与衰弱效果叠加

---

### 引力（Gravity）

**触发时机**：OnTravel / OnEffectObj

**效果机制**：
- OnTravel 阶段：弹道飞行过程中对周围单位施加吸附力
- OnEffectObj 阶段：命中时在命中位置生成引力场
- 引力场持续吸引范围内的单位向中心移动

**视觉效果**：
- 弹道周围出现引力扭曲特效
- 命中位置生成引力场视觉特效（如黑洞效果）
- 通过 `SpawnAnimRequest` 生成引力场动画

**数值范围**：
- 引力范围：2 - 4 单位半径
- 引力强度：中等（可被目标移动抵抗）
- 引力场持续时间：2 - 4 秒

---

### 懵逼（Daze）

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，清除目标的下一次攻击指令
- 打断目标当前正在执行的攻击动作
- 使目标短暂失去战斗节奏

**视觉效果**：
- 目标头上出现眩晕标记（如星星特效）
- 目标动作可能短暂停顿

**数值范围**：
- 清除攻击指令数量：1 - 2 个
- 打断范围：当前攻击动作
- 不影响目标的移动和其他行为

---

## 罕见词条（Epic）

### 怜悯（Mercy）

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，判断伤害是否会导致目标死亡
- 如果伤害足以致死，则将目标血量降至 1 点而非击杀
- 与死亡类词条（如终焉死亡）互斥，若存在则跳过此效果

**视觉效果**：
- 致命伤害时出现特殊的怜悯特效（如金色光芒）
- 目标血量降至 1 时显示特殊标记

**数值范围**：
- 触发条件：伤害 >= 目标当前血量
- 保底血量：1 点
- 不影响其他伤害计算

---

### 混乱（Chaos）

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，对目标施加混乱状态
- 混乱状态下目标会无差别攻击，包括友方单位
- 目标失去敌我识别能力

**视觉效果**：
- 目标身上出现紫色混乱粒子特效
- 通过 `AttachAnimRequest` 附加混乱光环
- 目标攻击时可能出现混乱标记

**数值范围**：
- 混乱持续时间：3 - 6 秒
- 攻击目标选择：完全随机（包括友方）
- 不影响目标的移动和防御行为

---

### 颠倒（Swap）

**触发时机**：技能结束后

**效果机制**：
- 技能释放结束后，交换施法者与目标的位置
- 如果目标已死亡，则仅移动施法者到目标位置
- 可用于战术位移和追击

**视觉效果**：
- 位置交换时出现传送特效
- 通过 `SpawnAnimRequest` 在双方位置生成传送动画

**数值范围**：
- 交换范围：无限制（但受目标位置限制）
- 交换时机：技能完全结束后
- 如果目标已死亡，仅施法者移动

---

### 随机（Random Affix）

**触发时机**：技能释放时

**效果机制**：
- 技能释放时进行二次抽取，随机获得一个非冲突词条
- 临时应用该词条的效果，仅对本次技能释放有效
- 抽取的词条不能与已有词条冲突

**视觉效果**：
- 技能释放时可能出现随机特效闪烁
- 根据抽取的词条显示对应的视觉效果

**数值范围**：
- 抽取范围：所有非冲突词条
- 抽取权重：按稀有度权重计算
- 效果持续时间：仅本次技能释放

---

### 燃尽（Burnout）

**触发时机**：OnSetup / OnEffectObj

**效果机制**：
- OnSetup 阶段：大幅提升技能伤害系数
- 技能释放后：消耗施法者大量灵气或增加技能冷却时间
- 以资源消耗换取高额伤害

**视觉效果**：
- 技能弹道带有强烈的燃尽光效（如橙色或红色火焰）
- 施法者身上可能出现灵气消耗特效

**数值范围**：
- 伤害提升：50% - 100%
- 灵气消耗：增加 30% - 50%
- 冷却时间：增加 20% - 40%

---

### 合击（Combo）

**触发时机**：技能释放时

**效果机制**：
- 技能释放时，追加释放一个随机技能的 SkillContainer
- 两个技能同时或连续释放，形成组合技
- 追加的技能从施法者的技能库中随机选择

**视觉效果**：
- 同时或连续出现两个技能的视觉效果
- 可能出现组合技的特殊标记

**数值范围**：
- 追加技能选择：从施法者技能库随机
- 释放时机：原技能释放后立即或同时
- 追加技能消耗独立计算

---

## 珍稀词条（Legendary）

### 封印（Silence）

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，对目标施加沉默状态
- 沉默状态下目标无法使用任何技能
- 仅影响技能释放，不影响普通攻击和移动

**视觉效果**：
- 目标身上出现封印符文特效
- 通过 `AttachAnimRequest` 附加封印光环
- 目标尝试使用技能时出现封印阻止特效

**数值范围**：
- 沉默持续时间：5 - 10 秒
- 影响范围：所有技能（包括主动和被动触发）
- 可被净化效果解除

---

### 终焉死亡（Death Sentence）

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，进行境界判定
- 如果目标境界等于或低于施法者，则直接判定为必死
- 无视目标当前血量和防御，强制击杀
- 与怜悯词条互斥

**视觉效果**：
- 触发时出现强烈的死亡特效（如黑色能量或死亡标记）
- 目标被标记为必死时显示特殊动画
- 通过 `SpawnAnimRequest` 生成终焉死亡特效

**数值范围**：
- 境界判定：目标境界 <= 施法者境界
- 必死判定：无视所有防御和血量
- 如果目标境界高于施法者，则按正常伤害计算

---

### 轮回试练（Reincarnation Trial）

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，进行境界判定
- 如果目标境界等于或低于施法者，则有一定概率重置目标的修为
- 修为重置后目标需要重新修炼
- 不影响目标的境界上限

**视觉效果**：
- 触发时出现轮回特效（如转轮或时间倒流效果）
- 目标修为重置时显示特殊动画
- 通过 `SpawnAnimRequest` 生成轮回试练特效

**数值范围**：
- 境界判定：目标境界 <= 施法者境界
- 触发概率：30% - 60%
- 修为重置：降至初始修为（如练气初期）
- 不影响境界上限和已学技能

---

### 永世诅咒（Eternal Curse）

**触发时机**：OnEffectObj

**效果机制**：
- 技能命中目标时，对目标施加长效诅咒标记
- 诅咒效果持续影响目标，直到满足解除条件
- 诅咒会随目标转生、夺舍等行为继承
- 解除条件：目标修为追平或超过施法者，或目标死亡
- 需要在存档中标记诅咒状态

**视觉效果**：
- 目标身上出现持续的诅咒标记（如黑色符文或锁链）
- 通过 `AttachAnimRequest` 附加永世诅咒光环
- 诅咒期间持续显示诅咒特效

**数值范围**：
- 诅咒效果：持续降低目标属性或造成持续伤害
- 属性降低：10% - 20%（全属性）
- 持续伤害：每 5 秒造成技能基础伤害的 5% - 10%
- 解除条件：目标修为 >= 施法者修为，或目标死亡
- 继承机制：转生、夺舍后诅咒依然存在

---

## 词条冲突规则

- **连发类互斥**：双连发、三连发、多连发不能同时存在
- **死亡类互斥**：终焉死亡与怜悯不能同时存在（使用 `kill_override` 标签）
- **锁定与范围类**：锁定可能与部分范围类词条互斥（具体由实现决定）

## 触发时机说明

- **OnSetup**：技能创建时立即触发，用于初始化数值、修改发射器、附加跟随特效
- **OnEffectObj**：技能命中目标时触发，用于施加状态、造成伤害、生成命中特效
- **OnTravel**：弹道飞行过程中周期性触发，用于持续效果、引力吸附等
- **技能释放时**：技能开始释放的瞬间，用于随机抽取、合击等特殊机制
- **技能结束后**：技能完全结束（包括弹道消失）后触发，用于位置交换等延迟效果

